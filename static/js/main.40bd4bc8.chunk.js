(this.webpackJsonpEasy_Listening=this.webpackJsonpEasy_Listening||[]).push([[0],{22:function(e,t,a){e.exports=a(49)},27:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(14),i=a.n(r),o=(a(27),a(3)),u=a.n(o),l=a(4),c=a(15),h=a(16),p=a(17),d=a(20),m=a(18),v=a(2),f=a(21);var g,w=function(e){for(var t,a,n=e.length;n>0;)a=Math.floor(Math.random()*n),t=e[--n],e[n]=e[a],e[a]=t;return e},b=(a(29),a(30),a(19)),k=a.n(b),x=(a(48),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleKeyPress=function(e,t){var n=a.state.isEnd;"Space"===e.key?a.playAudio(t):"ArrowLeft"!==e.key||n?"ArrowRight"!==e.key||n||(g.currentTime=g.currentTime+3<g._startTime+g.duration?g.currentTime+=3:g.currentTime):g.currentTime=g.currentTime-3>g._startTime?g.currentTime-3:g._startTime},a.state={english_text:"",vietnames_text:"",final_text:[],guessWord:"",checkAnswer:[],createAnswer:[],key:0,index:0,storeIndex:"",countGuess:0,bool:!1,english:"",vietnames:"",submit:!0,value:"default",voice:"US English Male",valueInput:"",inputArr:[],urlDownLoad:"",urlYouTuBe:"",captions:[],duration:"",audioElement:"",starts:[],durations:[],count:0,results:[],isPlayArr:[],step:2,prevKey:-1,isEnd:!1,isLoaded:!1,defaultsYoutubeUrl:["https://www.youtube.com/watch?v","https://youtu.be/","https://m.youtube.com/watch?feature=youtu.be&v=","https://www.youtube.com/watch?feature=youtu.be&v="]},a.handleGuessButtons=a.handleGuessButtons.bind(Object(v.a)(a)),a.handleGuessBox=a.handleGuessBox.bind(Object(v.a)(a)),a.handleOtherButton=a.handleOtherButton.bind(Object(v.a)(a)),a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a.showAnswers=a.showAnswers.bind(Object(v.a)(a)),a.handleSelectChange=a.handleSelectChange.bind(Object(v.a)(a)),a.playAudio=a.playAudio.bind(Object(v.a)(a)),a.getDefaulCaption=a.getDefaulCaption.bind(Object(v.a)(a)),a.fetchEstimations=a.fetchEstimations.bind(Object(v.a)(a)),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=document.createElement("script");e.src="https://code.responsivevoice.org/responsivevoice.js?key=FdquDWj4",e.async=!0,document.body.appendChild(e)}},{key:"handleGuessBox",value:function(e){console.clear(),e!==this.state.key&&this.setState((function(t){return{key:e,index:0,countGuess:0}}))}},{key:"handleOtherButton",value:function(e){var t=e.target.value;"___"!==t&&window.responsiveVoice.speak(t,this.state.voice)}},{key:"handleGuessButtons",value:function(e){var t,a=this;try{t=e.target.value}catch(m){t=e}console.log(t);var n=this.state,s=n.key,r=n.storeIndex,i=n.countGuess,o=n.checkAnswer,u=(n.bool,n.createAnswer),l=r[s];i<1&&window.responsiveVoice.speak(t,this.state.voice);var c=this.state.final_text.slice(0,this.state.final_text.length);if(o[s][l].replace(",","").toLowerCase()===t.replace(",","").toLowerCase()){var h=u.slice(0,u.length);i>1&&window.responsiveVoice.speak(t,this.state.voice),c[s].splice(c[s].indexOf(o[s][l]),1),h[s][l]=o[s][l];var p=r.slice(0,r.length);p[s]=l+1,this.setState((function(e){return{createAnswer:h,index:l+1,guessWord:a.state.checkAnswer[s][l],final_text:c,storeIndex:p,countGuess:0,bool:!1,valueInput:""}})),l+1===o[s].length&&this.setState((function(e){return{index:0}}))}else{if((i+=1)>=2){var d="The next word is ".concat(o[s][l]);window.responsiveVoice.speak(d,this.state.voice),this.setState((function(e){return{valueInput:""}}))}this.setState((function(e){return{guessWord:o[s][l],countGuess:i,bool:!0}}))}}},{key:"handleReadText",value:function(e){0===this.state.final_text[e].length&&window.responsiveVoice.speak(this.state.english_text[e],this.state.voice)}},{key:"playAudio",value:function(e){try{var t,a,n=this.state,s=n.starts,r=n.durations,i=n.results,o=n.isPlayArr,u=n.prevKey,l=n.isEnd,c=n.step;e===i.length-1?(t=s[e*c],a=i.length%2!==0?r[e*c]+r[e*c+1]+1:r[e*c]+1,console.log("start",parseInt(t/60)+t%60/100,"duration",a)):(t=s[e*c],a=s[e*c+c]-s[e*c]-.15,console.log("start",parseInt(t/60)+t%60/100,"duration",a));var h=o.slice(0,o.length);if(console.log("Text: ",i[e]),e!==u&&-1!==u&&(h[u]||(h[u]=!h[u]),g.pause()),!o[e])try{g.pause()}catch(d){console.log("Don't Worry")}if(h[e]=!h[e],u!==e&&o[e]||!0===l){try{g.pause()}catch(d){}(g=document.createElement("video")).setAttribute("src",this.state.urlDownLoad),g.value=a,g._startTime=t,g.currentTime=t}!0===l&&(l=!1);var p=this;g.addEventListener("timeupdate",(function(){if(g.currentTime-g._startTime>=g.value&&(g.pause(),l=!0),l){var e=o.map((function(e){return!0}));p.setState({isPlayArr:e,isEnd:l})}})),o[e]&&g.play(),this.setState({isPlayArr:h,prevKey:e,isEnd:l})}catch(d){}}},{key:"generateButtons",value:function(){var e=this,t=this.state,a=t.final_text,n=t.createAnswer;return a.map((function(t,a){return s.a.createElement("section",{className:"Container",key:a,value:a,onMouseEnter:function(){return e.handleGuessBox(a)}},n[a].map((function(t,a){return s.a.createElement("button",{className:"Button",key:a,value:t,onClick:e.handleOtherButton},t)})),e.state.final_text[a].length>0?s.a.createElement("div",null,s.a.createElement("input",{type:"text",name:"valueInput",placeholder:"Typing Answer",value:e.state.key===a?e.state.valueInput:"",onChange:function(t){return e.handleChange(t,a)},style:{borderRadius:"5px",height:"30px",width:"200px",fontSize:"20px"}})):s.a.createElement("p",null),t.map((function(t,a){return s.a.createElement("button",{className:"Button",key:a,value:t,onClick:e.handleGuessButtons},t)})),s.a.createElement("div",null,s.a.createElement("button",{className:"Button",key:a,onClick:function(){return e.playAudio(a)},ref:"play",onKeyUp:function(t){return e.handleKeyPress(t,a)}},e.state.isPlayArr[a]?"Play":"Pause")),0===e.state.final_text[a].length?s.a.createElement("div",null,s.a.createElement("audio",{src:"https://media.vocaroo.com/mp3/9EciEJW3Cyt",autoPlay:!0,controls:!0,hidden:!0}),s.a.createElement("h1",{id:"meo"},e.state.results[a])):s.a.createElement("div",null,s.a.createElement("button",{className:"Button",style:{background:"#2c3e50",border:"none",color:"#e2e5e9"},key:a,onClick:function(){return e.showAnswers(a)}},"Show Answer")))}))}},{key:"handleChange",value:function(e,t){var a=this.state.index,n=this.state.checkAnswer,s=this.state.inputArr,r=s.slice(0,s.length),i=this.state.final_text;this.setState(Object(c.a)({},e.target.name,e.target.value),(function(){if(n.length>0){var e=i[t].map((function(e){return e.replace(",","").toLowerCase()}));if("meowmeow"===this.state.valueInput&&(window.responsiveVoice.speak("You say meowmeow",this.state.voice),0===this.state.final_text[t].length?this.setState({valueInput:"",index:a+1}):(this.handleGuessButtons(n[t][a]),this.setState({valueInput:""}))),this.state.valueInput.trim().toLowerCase()===n[t][a].toLowerCase()&&0===this.state.final_text[t].length){if(window.responsiveVoice.speak(this.state.valueInput,this.state.voice),a===n[t].length-1)new Audio("https://media.vocaroo.com/mp3/9EciEJW3Cyt").play(),console.log("Yes"),r[t]=!1;this.setState({valueInput:"",index:a+1,inputArr:r})}else e.includes(this.state.valueInput.trim().toLowerCase())&&" "===this.state.valueInput[this.state.valueInput.length-1]&&this.handleGuessButtons(this.state.valueInput.trim().toLowerCase())}}))}},{key:"handleSelectChange",value:function(e){var t=e.target.value,a=this.state.voice,n=this.state.final_text.slice(0,this.state.final_text.length),s=this.state.createAnswer.slice(0,this.state.createAnswer.length);switch(t){case"showanswer":for(var r=0;r<n.length;r++)n[r]=[],s[r]=this.state.checkAnswer[r];break;case"usmale":a="US English Male";break;case"usfemale":a="US English Female";break;case"ukmale":a="UK English Male";break;case"ukfemale":a="UK English Female"}this.setState({value:t,final_text:n,createAnswer:s,voice:a})}},{key:"showAnswers",value:function(e){var t=this.state.final_text.slice(0,this.state.final_text.length),a=this.state.createAnswer.slice(0,this.state.createAnswer.length);t[e]=[],a[e]=this.state.checkAnswer[e],this.setState((function(e){return{final_text:t,createAnswer:a}}))}},{key:"getDefaulCaption",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a,n,s,r,i,o,l,c,h,p,d,m,v,f,g;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[],n=[],s=[],e.next=6,k.a.get("https://video.google.com/timedtext?&lang=en&v="+t);case 6:for(r=e.sent,i=r.data.replace(new RegExp("&#39;","g"),"'").replace(new RegExp("&amp;#39;","g"),"'").replace(new RegExp("&amp;amp;","g"),"and").split("<transcript>"),(o=i[1].split("</text>")).pop(),l=0;l<o.length;l++)c=o[l].split(">"),h=c[0].split(" "),p=h[1].split("=")[1],d=h[2].split("=")[1],a.push(c[1].replace(new RegExp('[&/\\#,+()$~%.":*?<>{}]',"g"),"")),n.push(+p.replace(new RegExp('"',"g"),"")),s.push(+d.replace(new RegExp('"',"g"),""));if(m=a.length,v=[],m%2===0)for(f=0;f<m;f+=2)v.push(a[f]+" "+a[f+1]);else{for(g=0;g<m-1;g+=2)v.push(a[g]+" "+a[g+1]);v.push(a[m-1])}return e.abrupt("return",{captions:a,starts:n,durations:s,rawText:v});case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchEstimations",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a,n,s,r,i,o,l,c,h,p,d,m,v,f,g,w,b=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=b.length>1&&void 0!==b[1]?b[1]:"url",n=0;case 2:if(!(n<5)){e.next=36;break}return e.prev=3,(s=new FormData).append("text",t),r=void 0,r=0===n?"https://flaskforlistening.herokuapp.com/":"https://flaskforlistening".concat(n,".herokuapp.com/"),console.log(r),e.next=11,fetch(r+"api/"+a,{method:"post",body:s});case 11:return i=e.sent,e.next=14,i.json();case 14:if(o=e.sent,console.log(o),"caption"!==a){e.next=27;break}for(l=[],c=[],h=[],p=0;p<o.length;p++)d=o[p],l.push(d.start),c.push(d.duration),h.push(d.text);if(m=h.length,v=[],f=4,m%2===0)for(g=0;g<m;g+=f)v.push(h[g]+" "+h[g+1]+" "+h[g+2]+" "+h[g+3]);else{for(w=0;w<m-1;w+=f)v.push(h[w]+" "+h[w+1]+" "+h[w+2]+" "+h[w+3]);v.push(h[m-1])}return this.setState({step:f}),e.abrupt("return",{captions:h,starts:l,durations:c,rawText:v});case 27:return e.abrupt("return",o);case 30:e.prev=30,e.t0=e.catch(3),console.log(e.t0);case 33:n++,e.next=2;break;case 36:return e.abrupt("return",!1);case 37:case"end":return e.stop()}}),e,this,[[3,30]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a,n,s,r,i,o,l,c,h,p,d,m,v,f,g,b,k,x,y,E;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!((a=this.state.urlYouTuBe.split("/")).length>0)){e.next=58;break}if(this.setState({submit:!1}),!(0===this.state.captions.length&&this.state.urlYouTuBe.length>0)){e.next=58;break}a=this.state.urlYouTuBe,n="",s=0;case 8:if(!(s<this.state.defaultsYoutubeUrl.length)){e.next=25;break}if(a.indexOf(this.state.defaultsYoutubeUrl[s])){e.next=22;break}e.t0=s,e.next=0===e.t0?13:1===e.t0?15:2===e.t0?17:3===e.t0?19:21;break;case 13:return n=a.split("=")[1].split("&")[0],e.abrupt("break",22);case 15:return n=a.split("/")[3].slice(0,11),e.abrupt("break",22);case 17:return n=a.split("=")[2],e.abrupt("break",22);case 19:return n=a.split("&")[1].split("=")[1],e.abrupt("break",22);case 21:return e.abrupt("break",22);case 22:s++,e.next=8;break;case 25:return r=this.state.defaultsYoutubeUrl[0]+"="+n,e.next=28,this.getDefaulCaption(n);case 28:return i=e.sent,e.next=31,this.fetchEstimations(r);case 31:if(o=e.sent,!1!==i){e.next=41;break}return e.next=35,this.fetchEstimations(n,"caption");case 35:if(!1!==(i=e.sent)){e.next=39;break}return alert("Please select a video with subtitles"),e.abrupt("return");case 39:e.next=44;break;case 41:if(!1!==o){e.next=44;break}return alert("500 Internal Server Error"),e.abrupt("return");case 44:for(l=i.rawText,c=i.starts,h=i.durations,p=i.captions,d=[],m=[],v=[],f=[],g=[],b=[],k=[],x=0;x<l.length;x++){for(y=[],g.push(l[x].split(" ")),b.push(l[x].split(" ")),m.push(!0),v.push(0),k.push(!0),f.push(0),E=0;E<l[x].split(" ").length;E++)y.push("___");d.push(y)}b.forEach((function(e){return w(e)})),this.setState({captions:p,urlDownLoad:o,starts:c,durations:h,results:l,final_text:b,createAnswer:d,inputArr:m,storeIndex:v,show:f,checkAnswer:g,isPlayArr:k,isLoaded:!0});case 58:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.generateButtons();return this.state.guessWord===this.state.english_text[this.state.key]&&console.log("Your answer is correct"),s.a.createElement("div",{className:"App"},this.state.submit?s.a.createElement("div",{id:"form"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("label",null,s.a.createElement("input",{type:"text",name:"urlYouTuBe",placeholder:"LinkYouTuBe",value:this.state.urlYouTuBe,onChange:this.handleChange})),s.a.createElement("button",{id:"submit"},"Submit!"))):s.a.createElement("div",null,this.state.isLoaded?s.a.createElement("div",null,s.a.createElement("section",{id:"meo"},s.a.createElement("form",{onSubmit:this.showAnswers},s.a.createElement("label",null,s.a.createElement("div",{className:"select"},s.a.createElement("select",{name:"slct",id:"slct",value:this.state.value,onChange:this.handleSelectChange},s.a.createElement("option",{value:"default"},"Choose an option"),s.a.createElement("option",{value:"showanswer"},"Show Answers"),s.a.createElement("option",{value:"usmale"},"US English Male Voice"),s.a.createElement("option",{value:"usfemale"},"US English FeMale Voice"),s.a.createElement("option",{value:"ukmale"},"UK English Male Voice"),s.a.createElement("option",{value:"ukfemale"},"UK English FeMale Voice")))))),s.a.createElement("p",{className:"content-btns"},e)):s.a.createElement("div",{className:"wrapper"},s.a.createElement("div",{className:"rubik-loader"}))))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.40bd4bc8.chunk.js.map